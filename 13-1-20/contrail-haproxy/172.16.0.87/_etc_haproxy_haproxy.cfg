global
    log /dev/log local0
    log /dev/log local1 notice
    maxconn 4096
    user haproxy
    group haproxy
    spread-checks 0
    tune.ssl.default-dh-param 1024
    ssl-default-bind-ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:!DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:!DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:!CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA

defaults
    log global
    mode http
    option httplog
    option dontlognull
    retries 3
    timeout queue 60000
    timeout connect 5000
    timeout client 120000
    timeout server 120000



frontend contrail-haproxy-0-10000
    bind 0.0.0.0:10000
    default_backend haproxy_monitoring
    mode http
    acl allowed_cidr src 127.0.0.1/32
    http-request deny unless allowed_cidr

backend haproxy_monitoring
    mode http
    stats enable
    stats uri /
    stats realm Haproxy\ Statistics
    stats auth haproxy:4V4TKSYtdw42n95GFw9y
    stats refresh 3

frontend contrail-haproxy-0-8143
    bind 172.16.0.100:8143
    default_backend contrail-webui-https
    mode tcp
    option tcplog

backend contrail-webui-https
    mode tcp
    option tcplog
    balance source
    cookie SERVERID insert indirect nocache
    server contrail-controller-0 172.16.0.91:8143 cookie 172.16.0.91 weight 1 maxconn 1024 check port 8143

frontend contrail-haproxy-0-8081
    bind 172.16.0.100:8081
    default_backend contrail-analytics-api
    timeout client 3m

backend contrail-analytics-api
    option nolinger
    timeout server 3m
    balance source
    server contrail-analytics-0 172.16.0.92:8081 check inter 2000 rise 2 fall 3

frontend contrail-haproxy-0-8082
    bind 172.16.0.100:8082
    default_backend contrail-api
    timeout client 3m

backend contrail-api
    option nolinger
    timeout server 3m
    balance source
    server contrail-controller-0 172.16.0.91:8082 check inter 2000 rise 2 fall 3


